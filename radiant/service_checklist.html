<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- ====== META & GLOBALS ====== -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Volunteer Service Checklist – Radiant Production</title>

    <!-- Google Analytics (kept from existing pages) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VSK4JT56BT"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-VSK4JT56BT");
    </script>

    <!-- Fonts & Global Styles -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="global.css" />

    <!-- Material Symbols (logo icon) -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=graphic_eq"
    />

    <!-- ====== PAGE-SPECIFIC STYLES ====== -->
    <style>
      :root {
        /* match existing color system */
        --primary: #0549df;
        --bg-light: rgba(249, 249, 249, 0.85);
        --text-dark: #1e1e1e;
      }

      body {
        margin: 0;
        font-family: "Roboto", sans-serif;
        color: var(--text-dark);
      }

      /* ---------- NAV HEADER (copied styles reside in global.css) ---------- */

      /* ---------- LAYOUT ---------- */
      main.service-assistant {
        max-width: 960px;
        margin: 0 auto;
        padding: 96px 24px 64px; /* account for fixed nav */
      }

      /* ---------- ROLE SELECTION ---------- */
      .choose-role {
        text-align: center;
        margin-bottom: 48px;
      }
      .choose-role h1 {
        font-size: 2.5rem;
        margin: 0 0 8px;
      }
      .choose-role p {
        margin: 0 0 24px;
        font-size: 1.125rem;
      }
      .choose-role select {
        font-size: 1.125rem;
        padding: 12px 16px;
        border: 1px solid #ccc;
        border-radius: 6px;
        background: var(--bg-light);
        cursor: pointer;
      }

      /* ---------- TIMER ---------- */
      #timerSection {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        margin-bottom: 48px;
      }
      .timer-widget {
        font-size: 2.5rem;
        font-weight: 700;
        letter-spacing: 0.05em;
        background: var(--primary);
        color: #fff;
        padding: 12px 24px;
        border-radius: 12px;
        min-width: 220px;
        text-align: center;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
      }
      #timerSection small {
        opacity: 0.7;
      }

      /* ---------- ROLE DETAILS / TASKS ---------- */
      #roleDetails h2 {
        margin: 0 0 8px;
        font-size: 2rem;
        color: var(--primary);
      }
      #roleDetails p.description {
        font-size: 1.125rem;
        margin: 0 0 24px;
      }
      .task-group {
        list-style: none;
        padding: 0;
        margin: 0 0 32px;
      }
      .task-group-title {
        margin: 24px 0 8px;
        font-size: 1.25rem;
        font-weight: 700;
        text-transform: uppercase;
        color: var(--text-dark);
      }
      .task-item {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        margin: 6px 0;
      }
      .task-item input[type="checkbox"] {
        transform: scale(1.25);
        margin-top: 4px;
        cursor: pointer;
      }
      .task-item label {
        cursor: pointer;
      }
      .task-item input[type="checkbox"]:checked + label {
        text-decoration: line-through;
        opacity: 0.6;
      }

      /* ---------- MEDIA ---------- */
      @media (max-width: 600px) {
        .timer-widget {
          font-size: 2rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- ====== NAVBAR (copied markup, removes hero for simplicity) ====== -->
    <header class="nav-header">
      <div class="nav-content">
        <a href="/" class="logo">
          <span class="material-symbols-outlined">graphic_eq</span>
          RADIANT PRODUCTION
        </a>

        <!-- Hamburger Menu Button -->
        <button class="menu-toggle" aria-label="Open menu">
          <span class="bar bar1"></span>
          <span class="bar bar2"></span>
          <span class="bar bar1"></span>
        </button>

        <nav class="nav-links">
          <button class="cta"><a href="home.html" class="hover-underline-animation">Home</a></button>
          <button class="cta"><a href="volunteers.html" class="hover-underline-animation">Volunteers</a></button>
          <div class="dropdown">
            <button class="cta"><a href="gear.html" class="hover-underline-animation">Our Gear &#9660;</a></button>
            <div class="dropdown-content">
              <a href="audio_gear.html">Audio</a>
              <a href="video_gear.html">Video</a>
              <a href="lighting_gear.html">Lighting</a>
            </div>
          </div>
          <button class="cta"><a href="stage.html" class="hover-underline-animation">Stage Design History</a></button>
          <button class="cta"><a href="contact.html" class="hover-underline-animation">Connect</a></button>
        </nav>
      </div>
    </header>

    <!-- ====== MAIN CONTENT ====== -->
    <main class="service-assistant">
      <!-- === ROLE SELECTION === -->
      <section class="choose-role">
        <h1>Volunteer Service Assistant</h1>
        <p>Select your position to load your personalized checklist & live timer.</p>
        <select id="roleSelect">
          <option value="" selected disabled>Choose your role…</option>
          <option value="stage-manager">Stage Manager</option>
          <option value="video-director">Video Director</option>
          <option value="audio-engineer">Audio Engineer (Broadcast & FOH)</option>
          <option value="lighting-engineer">Lighting Engineer (grandMA3)</option>
          <option value="camera-operator">Camera Operator</option>
          <option value="computer-graphics">Computer Graphics Operator</option>
          <option value="photographer">Photographer</option>
          <option value="online-host">Online Host</option>
        </select>
      </section>

      <!-- === TIMER === -->
      <section id="timerSection" hidden>
        <h2>Currently Running Timer</h2>
        <div class="timer-widget" id="timerDisplay">--:--:--</div>
        <small>Synced from <code>http://192.168.1.51:8888/v1/timers/current</code></small>
      </section>

      <!-- === ROLE DETAILS / TASKS === -->
      <section id="roleDetails" hidden></section>
    </main>

    <!-- ====== SCRIPTS ====== -->
    <script src="global.js"></script>
    <script>
      /* -------------------------------------------------------------------------
       *  DATA SOURCE – add/extend roles here
       * -----------------------------------------------------------------------*/
      const rolesData = {
        "stage-manager": {
          name: "Stage Manager",
          description: "Ensures stage flow, cues, and transitions run smoothly.",
          tasks: {
            preservice: [
              "Conduct microphone and in-ear battery checks.",
              "Verify that communion elements, baby dedication items, and illustrations are in place.",
              "Ensure all instruments and podium/table are properly positioned and spike-taped.",
              "Launch and monitor Planning Center Live."
            ],
            service: [
              "Operate and manage Planning Center Live throughout the service.",
              "Verbally communicate service transitions, upcoming songs, and cues from PCO.",
              "Bring communion elements, baby dedication items, and illustration props on stage as needed.",
              "Move instruments after worship to clear the stage for the message.",
              "Bring podium to the front of the stage for the message.",
              "Coordinate with the worship team to prepare for the final song or underscore.",
              "Coordinate with the speakers for when to go onstage."
            ],
            postservice: [
              "Collect and store all microphones and batteries."
            ]
          }
        },
        "video-director": {
          name: "Video Director",
          description: "Leads the live video production team and camera crew.",
          tasks: {
            preservice: [
              "Ensure all cameras are correctly set up and positioned.",
              "Distribute and test headsets for track cameras."
            ],
            service: [
              "Direct all camera operations.",
              "Coordinate with the graphics team on slide timing."
            ],
            postservice: [
              "Take down all cameras.",
              "Store all headsets."
            ]
          }
        },
        "audio-engineer": {
          name: "Audio Engineer (Broadcast & FOH)",
          description: "Delivers an immersive worship mix and broadcast-quality audio.",
          tasks: {
            preservice: [
              "Set up audio equipment and cables before service.",
              "Conduct sound checks and adjust levels for optimal performance.",
              "Coordinate with the technical team to ensure broadcast readiness."
            ],
            service: [
              "Mix front-of-house audio to create an immersive worship experience.",
              "Manage broadcast feeds for clear and uninterrupted transmission.",
              "Monitor and adjust audio levels in real time during the service."
            ],
            postservice: [
              "Safely break down and store all audio equipment.",
              "Review recorded audio for quality and consistency.",
              "Log any technical issues for follow-up and improvement."
            ]
          }
        },
        "lighting-engineer": {
          name: "Lighting Engineer (grandMA3)",
          description: "Creates dynamic, distraction-free lighting to support worship.",
          tasks: {
            preservice: [
              "Adjust lighting colors during practice if needed.",
              "Ensure cue stack aligns with Planning Center.",
              "Test all cues to confirm smooth transitions and proper functionality."
            ],
            service: [
              "Anticipate transitions to ensure seamless lighting changes."
            ],
            postservice: [
              "Set end-of-service cue."
            ]
          }
        },
        "camera-operator": {
          name: "Camera Operator",
          description: "Captures engaging shots that communicate the story on screen.",
          tasks: {
            preservice: [
              "Ensure assigned camera is set up, operational, and service-ready.",
              "Have a functioning headset.",
              "Familiarize yourself with the service order to anticipate key moments (e.g., communion, dedications)."
            ],
            service: [
              "Follow all cues from the service and video directors.",
              "Cam 3: Set up the camera on a tripod after worship."
            ],
            postservice: [
              "Properly store camera and headset.",
              "Charge all batteries."            
            ]
          }
        },
        "computer-graphics": {
          name: "Computer Graphics Operator",
          description: "Drives lyrics, lower thirds, and media cues in ProPresenter.",
          tasks: {
            preservice: [
              "Attend worship practice.",
              "Ensure ProPresenter is complete and follows Planning Center.",
              "Understand service elements to anticipate transitions.",
              "Test all videos and graphics."
            ],
            service: [
              "Follow cues from the video and service directors for slide transitions."            
            ],
            postservice: [
              "Display end-of-service graphic."            
            ]
          }
        },
        "photographer": {
          name: "Photographer",
          description: "Captures compelling imagery for recap and promotion.",
          tasks: {
            preservice: [
              "Plan a shot list and set camera parameters according to venue lighting.",
              "Scout the venue for optimal photo opportunities.",
              "Coordinate with the creative team to capture the intended mood."
            ],
            service: [
              "Capture key moments during the service, balancing candid and posed shots.",
              "Adjust camera settings in response to changing lighting conditions.",
              "Continuously monitor composition and framing."            
            ],
            postservice: [
              "Backup and edit photos to enhance quality.",
              "Prepare digital galleries for sharing with the team and congregation.",
              "Report any equipment issues for prompt repair or replacement."            
            ]
          }
        },
        "online-host": {
          name: "Online Host",
          description: "Engages the online congregation and facilitates digital community.",
          tasks: {
            preservice: [
              "Prepare virtual engagement tools and ensure all online platforms are tested.",
              "Coordinate with the technical team to guarantee a stable connection.",
              "Test audio and video settings for online streaming."
            ],
            service: [
              "Engage with the online audience during the live service.",
              "Monitor social media and live chat for real-time interaction.",
              "Coordinate with on-site teams to ensure a seamless broadcast experience."            
            ],
            postservice: [
              "Review online feedback and interaction logs.",
              "Compile audience engagement reports for the team.",
              "Prepare for subsequent online sessions based on received feedback."            
            ]
          }
        }
      };

      /* ---------------------------------------------------------------------
       *  DOM REFERENCES
       * -------------------------------------------------------------------*/
      const roleSelect = document.getElementById("roleSelect");
      const roleDetails = document.getElementById("roleDetails");
      const timerSection = document.getElementById("timerSection");
      const timerDisplay = document.getElementById("timerDisplay");

      /* ---------------------------------------------------------------------
       *  ROLE HANDLING
       * -------------------------------------------------------------------*/
      roleSelect.addEventListener("change", (e) => {
        const key = e.target.value;
        if (!key) return;
        renderRole(key);
        timerSection.hidden = false;
        startTimer();
        roleDetails.scrollIntoView({ behavior: "smooth" });
      });

      function renderRole(key) {
        const data = rolesData[key];
        if (!data) {
          roleDetails.innerHTML = "<p>Role not found.</p>";
          roleDetails.hidden = false;
          return;
        }

        // Build HTML
        let html = `
          <h2>${data.name}</h2>
          <p class="description">${data.description}</p>
          ${renderTaskGroup("PRE-SERVICE", data.tasks.preservice, key, "pre")}
          ${renderTaskGroup("SERVICE", data.tasks.service, key, "service")}
          ${renderTaskGroup("POST-SERVICE", data.tasks.postservice, key, "post")}
        `;

        roleDetails.innerHTML = html;
        roleDetails.hidden = false;

        // attach listeners & restore state
        roleDetails
          .querySelectorAll("input[type=checkbox]")
          .forEach((cb) => {
            cb.addEventListener("change", saveTaskState);
          });

        restoreTaskState(key);
      }

      function renderTaskGroup(title, tasks, roleKey, phase) {
        if (!tasks || tasks.length === 0) return "";
        const list = tasks
          .map((task, i) => {
            const id = `${roleKey}_${phase}_${i}`;
            return `<li class="task-item"><input type="checkbox" id="${id}" data-store-key="${id}"><label for="${id}">${task}</label></li>`;
          })
          .join("");
        return `
          <h3 class="task-group-title">${title}</h3>
          <ul class="task-group">${list}</ul>`;
      }

      /* ---- LocalStorage Persistence ---- */
      function saveTaskState(e) {
        const key = e.target.dataset.storeKey;
        localStorage.setItem(key, e.target.checked ? "1" : "0");
      }
      function restoreTaskState(roleKey) {
        roleDetails
          .querySelectorAll("input[type=checkbox]")
          .forEach((cb) => {
            const key = cb.dataset.storeKey;
            cb.checked = localStorage.getItem(key) === "1";
          });
      }

      /* ---------------------------------------------------------------------
       *  TIMER – pulls JSON { countdown: "HH:MM:SS" } from bitfocus companion
       *          falls back to client clock if endpoint unreachable
       * -------------------------------------------------------------------*/
      let timerInterval = null;
      const TIMER_ENDPOINT = "http://192.168.1.51:8888/v1/timers/current";

      function startTimer() {
        if (timerInterval) clearInterval(timerInterval);
        fetchAndUpdateTimer();
        timerInterval = setInterval(fetchAndUpdateTimer, 1000);
      }

      async function fetchAndUpdateTimer() {
        try {
          const res = await fetch(TIMER_ENDPOINT);
          if (!res.ok) throw new Error("Bad response");
          const { countdown } = await res.json();
          timerDisplay.textContent = countdown || "--:--:--";
        } catch (err) {
          // graceful fallback to local clock
          const now = new Date();
          timerDisplay.textContent = now.toLocaleTimeString();
        }
      }

      /* ---------------------------------------------------------------------
       *  NAV-BAR BEHAVIOR (copied from existing site for consistency)
       * -------------------------------------------------------------------*/
      const navHeader = document.querySelector(".nav-header");
      let lastScrollY = window.scrollY;
      window.addEventListener("scroll", () => {
        const currentScrollY = window.scrollY;
        if (currentScrollY > lastScrollY && currentScrollY > 0) {
          navHeader.classList.add("hidden");
        } else {
          navHeader.classList.remove("hidden");
        }
        lastScrollY = currentScrollY;
      });

      // Mobile menu toggle
      document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.querySelector(".menu-toggle");
        const navLinks = document.querySelector(".nav-links");
        menuToggle.addEventListener("click", function () {
          navLinks.classList.toggle("open");
          menuToggle.classList.toggle("open");
        });
      });
    </script>
  </body>
</html>